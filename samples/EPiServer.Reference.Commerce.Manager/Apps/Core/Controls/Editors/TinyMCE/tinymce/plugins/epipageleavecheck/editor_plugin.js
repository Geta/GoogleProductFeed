(function(a,c){var b=a.dom.Event;a.create("tinymce.plugins.epipageleavecheck",{init:function(f,i){var h;var g;var d;var k;var j;var l=a.DOM,e=a.dom.Event;f.onChange.add(function(m){if(!d){g=true;}});f.onPostRender.add(function(p){var o,m;var n=function(q){if(o){e.remove(l.doc,"mouseup",o);}if(m){e.remove(p.getDoc(),"mouseup",m);}window.setTimeout(function(){EPi.PageLeaveCheck.enabled=true;},1);};e.add(p.id+"_resize","mousedown",function(q){o=e.add(l.doc,"mouseup",n);m=e.add(p.getDoc(),"mouseup",n);EPi.PageLeaveCheck.enabled=false;});});f.onSetContent.add(function(m,n){if(!j){if(m.id==="mce_fullscreen"){if(!n.initial){k=a.trim(m.getContent({format:"html",no_events:1}));j=true;}}else{k=a.trim(m.getContent({format:"html",no_events:1}));j=true;}}});if(typeof(EPi)!=="undefined"&&typeof(EPi.PageLeaveCheck)!=="undefined"){EPi.PageLeaveCheck.AddToChecklist(function(n){if(typeof(n)!=="undefined"){h=n;g=false;d=true;}if(g){if(f.getDoc()!=null){var m=k!="";var o=a.trim(f.getContent({format:"html",no_events:m}));h=(k!=o);}else{h=false;}}f.isNotDirty=!h;return h;});}},getInfo:function(){return{longname:"Page Leave Check plugin",author:"EPiServer AB",authorurl:"http://www.episerver.com",infourl:"http://www.episerver.com",version:1};}});a.PluginManager.add("epipageleavecheck",a.plugins.epipageleavecheck);}(tinymce,epiJQuery));