(function(){tinymce.create("tinymce.plugins.WordCount",{block:0,id:null,countre:null,cleanre:null,init:function(d,a){var b=this,c=0;b.countre=d.getParam("wordcount_countregex",/\S\s+/g);b.cleanre=d.getParam("wordcount_cleanregex",/[0-9.(),;:!?%#$Â¿'"_+=\\\/-]*/g);b.id=d.id+"-word-count";d.onPostRender.add(function(h,g){var e,f;f=h.getParam("wordcount_target_id");if(!f){e=tinymce.DOM.get(h.id+"_path_row");if(e){tinymce.DOM.add(e.parentNode,"div",{style:"float: right"},h.getLang("wordcount.words","Words: ")+'<span id="'+b.id+'">0</span>');}}else{tinymce.DOM.add(f,"span",{},'<span id="'+b.id+'">0</span>');}});d.onInit.add(function(e){e.selection.onSetContent.add(function(){b._count(e);});b._count(e);});d.onSetContent.add(function(e){b._count(e);});d.onKeyUp.add(function(f,g){if(g.keyCode==c){return;}if(13==g.keyCode||8==c||46==c){b._count(f);}c=g.keyCode;});},_count:function(c){var b=this,a=0;if(b.block){return;}b.block=1;setTimeout(function(){var d=c.getContent({format:"raw"});if(d){d=d.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ");d=d.replace(b.cleanre,"");d.replace(b.countre,function(){a++;});}tinymce.DOM.setHTML(b.id,a.toString());setTimeout(function(){b.block=0;},2000);},1);},getInfo:function(){return{longname:"Word Count plugin",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/wordcount",version:tinymce.majorVersion+"."+tinymce.minorVersion};}});tinymce.PluginManager.add("wordcount",tinymce.plugins.WordCount);})();