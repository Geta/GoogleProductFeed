(function(b,a){b.create("tinymce.plugins.epifilemanagerdragdrop",{init:function(c,d){if(a){c.onInit.add(function(e){a(e.getBody()).bind("dragover",function(i){if(/chrome/.test(navigator.userAgent.toLowerCase())){if(i.originalEvent.dataTransfer.types&&a.inArray("text/html",i.originalEvent.dataTransfer.types)!=-1){return;}var f=i.target.ownerDocument.caretRangeFromPoint(i.originalEvent.clientX,i.originalEvent.clientY);if(f&&f.startContainer){var h=e.selection.getRng();h.setStart(f.startContainer,f.startOffset);h.collapse(true);e.focus();var g=i.target.ownerDocument.getSelection();g.removeAllRanges();g.addRange(h);i.preventDefault();}}});a(e.getBody()).bind("drop",function(o){var p=/^\S+\.*(jpg|jpeg|jpe|ico|gif|bmp|png)$/;var f=o.originalEvent;if(f){var j="";var g=f.dataTransfer.getData("Text");try{var i=b.util.JSON.parse(g);if(i){g=i.data;}}catch(k){}if(g&&g.length&&g.charAt(0)=="/"){if(g.toLowerCase().match(p,"i")){j='<img src="'+g+'" alt="" />';}else{var q=g;var h=g.lastIndexOf("/");if(h>-1){q=decodeURI(g.substring(h+1,g.length));}j='<a target="_blank" href="'+g+'">'+q+"</a>";}e.focus();var n=e.selection;if(f.rangeParent){var l=n.getRng();l.setStart(f.rangeParent,f.rangeOffset);l.collapse(true);n.setRng(l);}else{if(/chrome/.test(navigator.userAgent.toLowerCase())){var m=o.target.ownerDocument.caretRangeFromPoint(o.originalEvent.clientX,o.originalEvent.clientY);if(m&&m.startContainer){var l=n.getRng();l.setStart(m.startContainer,m.startOffset);l.collapse(true);n.setRng(l);}}}n.setContent(j);e.undoManager.add();return false;}}});});}},getInfo:function(){return{longname:"Drag & Drop from FileManager plugin",author:"EPiServer AB",authorurl:"http://www.episerver.com",infourl:"http://www.episerver.com",version:"1.0"};}});b.PluginManager.add("epifilemanagerdragdrop",b.plugins.epifilemanagerdragdrop);}(tinymce,epiJQuery));