(function(){tinymce.create("tinymce.plugins.FullPagePlugin",{init:function(c,a){var b=this;b.editor=c;c.addCommand("mceFullPageProperties",function(){c.windowManager.open({file:a+"/fullpage.htm",width:430+parseInt(c.getLang("fullpage.delta_width",0)),height:495+parseInt(c.getLang("fullpage.delta_height",0)),inline:1},{plugin_url:a,head_html:b.head});});c.addButton("fullpage",{title:"fullpage.desc",cmd:"mceFullPageProperties"});c.onBeforeSetContent.add(b._setContent,b);c.onSetContent.add(b._setBodyAttribs,b);c.onGetContent.add(b._getContent,b);},getInfo:function(){return{longname:"Fullpage",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/fullpage",version:tinymce.majorVersion+"."+tinymce.minorVersion};},_setBodyAttribs:function(b,f){var g,a,e,h,c,l,j,d=this.head.match(/body(.*?)>/i);if(d&&d[1]){g=d[1].match(/\s*(\w+\s*=\s*".*?"|\w+\s*=\s*'.*?'|\w+\s*=\s*\w+|\w+)\s*/g);if(g){for(a=0,e=g.length;a<e;a++){h=g[a].split("=");c=h[0].replace(/\s/,"");l=h[1];if(l){l=l.replace(/^\s+/,"").replace(/\s+$/,"");j=l.match(/^["'](.*)["']$/);if(j){l=j[1];}}else{l=c;}b.dom.setAttrib(b.getBody(),"style",l);}}}},_createSerializer:function(){return new tinymce.dom.Serializer({dom:this.editor.dom,apply_source_formatting:true});},_setContent:function(b,e){var h=this,i,j,g=e.content,a,d="";if(e.format=="raw"&&h.head){return;}if(e.source_view&&b.getParam("fullpage_hide_in_source_view")){return;}g=g.replace(/<(\/?)BODY/gi,"<$1body");i=g.indexOf("<body");if(i!=-1){i=g.indexOf(">",i);h.head=g.substring(0,i+1);j=g.indexOf("</body",i);if(j==-1){j=g.indexOf("</body",j);}e.content=g.substring(i+1,j);h.foot=g.substring(j);function f(c){return c.replace(/<\/?[A-Z]+/g,function(k){return k.toLowerCase();});}h.head=f(h.head);h.foot=f(h.foot);}else{h.head="";if(b.getParam("fullpage_default_xml_pi")){h.head+='<?xml version="1.0" encoding="'+b.getParam("fullpage_default_encoding","ISO-8859-1")+'" ?>\n';}h.head+=b.getParam("fullpage_default_doctype",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');h.head+="\n<html>\n<head>\n<title>"+b.getParam("fullpage_default_title","Untitled document")+"</title>\n";if(a=b.getParam("fullpage_default_encoding")){h.head+='<meta http-equiv="Content-Type" content="'+a+'" />\n';}if(a=b.getParam("fullpage_default_font_family")){d+="font-family: "+a+";";}if(a=b.getParam("fullpage_default_font_size")){d+="font-size: "+a+";";}if(a=b.getParam("fullpage_default_text_color")){d+="color: "+a+";";}h.head+="</head>\n<body"+(d?' style="'+d+'"':"")+">\n";h.foot="\n</body>\n</html>";}},_getContent:function(c,a){var b=this;if(!a.source_view||!c.getParam("fullpage_hide_in_source_view")){a.content=tinymce.trim(b.head)+"\n"+tinymce.trim(a.content)+"\n"+tinymce.trim(b.foot);}}});tinymce.PluginManager.add("fullpage",tinymce.plugins.FullPagePlugin);})();