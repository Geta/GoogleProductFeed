(function(b,a){b.PluginManager.requireLangPack("epiquote");b.create("tinymce.plugins.epiquote",{init:function(e,c){var d=this;e.addCommand("mceEPiQuote",function(){e.windowManager.open({file:c+"/epiquote.htm",width:350,height:240,inline:1},{plugin_url:c});});e.addButton("epiquote",{title:"epiquote.desc",cmd:"mceEPiQuote","class":"mce_blockquote"});e.addShortcut("ctrl+shift+q","epiquote.desc","mceEPiQuote");e.onNodeChange.add(function(j,i,g,f){var h=j.dom.getParent(g,"q")!=null||j.dom.getParent(g,"blockquote")!=null;i.setDisabled("epiquote",f&&!h);i.setActive("epiquote",h);});e.onKeyUp.addToTop(function(f,g){if(g.keyCode==13){if(g.shiftKey||g.altKey||g.ctrlKey){return;}d._quoteEscape(f,g);}});},_quoteEscape:function(d,e){function j(l){return(l.innerHTML==""||l.innerHTML==" "||l.innerHTML=="<br>");}var k,i=d.selection,g=i.getNode(),h=d.dom.getParent(g,"blockquote");if(h!=null){var c=h.childNodes,f=c.length;if(j(g)&&c[f-1]===g&&j(c[f-2])){d.dom.remove(c[f-2]);d.dom.remove(g);k=d.dom.create("p",null," ");d.dom.insertAfter(k,h);i.select(k,true);i.collapse();b.dom.Event.cancel(e);d.undoManager.add();}}},getInfo:function(){return{longname:"Quote plugin",author:"EPiServer AB",authorurl:"http://www.episerver.com",infourl:"http://www.episerver.com",version:"1.0"};}});b.PluginManager.add("epiquote",b.plugins.epiquote);}(tinymce,epiJQuery));