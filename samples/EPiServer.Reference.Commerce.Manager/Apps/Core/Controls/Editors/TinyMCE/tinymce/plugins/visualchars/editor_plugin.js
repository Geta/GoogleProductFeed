(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(c,a){var b=this;b.editor=c;c.addCommand("mceVisualChars",b._toggleVisualChars,b);c.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"});c.onBeforeGetContent.add(function(d,e){if(b.state&&e.format!="raw"&&!e.draft){b.state=true;b._toggleVisualChars(false);}});},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion};},_toggleVisualChars:function(f){var j=this,a=j.editor,q,m,l,p=a.getDoc(),o=a.getBody(),k,g=a.selection,n,c,e;j.state=!j.state;a.controlManager.setActive("visualchars",j.state);if(f){e=g.getBookmark();}if(j.state){q=[];tinymce.walk(o,function(b){if(b.nodeType==3&&b.nodeValue&&b.nodeValue.indexOf("\u00a0")!=-1){q.push(b);}},"childNodes");for(m=0;m<q.length;m++){k=q[m].nodeValue;k=k.replace(/(\u00a0)/g,'<span _mce_bogus="1" class="mceItemHidden mceItemNbsp">$1</span>');c=a.dom.create("div",null,k);while(node=c.lastChild){a.dom.insertAfter(node,q[m]);}a.dom.remove(q[m]);}}else{q=a.dom.select("span.mceItemNbsp",o);for(m=q.length-1;m>=0;m--){a.dom.remove(q[m],1);}}g.moveToBookmark(e);}});tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars);})();